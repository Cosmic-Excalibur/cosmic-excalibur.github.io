<!DOCTYPE html>
<html>
<head>
	<link rel='icon' type='image/x-icon' href="/favicon.ico"/>
	<link rel='stylesheet' type='text/css' href="/essence-of-the-elders/skeleton-of-giants.css"/>
	<link rel='stylesheet' href='/essence-of-the-elders/spirit-of-codes/prism.css'/>
	<!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:100,300,400,500,700,900"> -->
	<meta charset="UTF-8"/>
	<title>2024 SpiritCTF Warmup Write-ups by Astrageldon</title>
</head>
<body>
	<div class="center">
		<h1>2024 SpiritCTF Warmup Write-ups by Astrageldon</h1>
		<ul class="navi">
			<li><a href="javascript:history.back()" class="noafter back" title="Back"></a></li>
			<li><a href="/" class="noafter home" title="Homepage"></a></li>
			<li><a href="javascript:history.forward()" class="noafter forward" title="Forward"></a></li>
		</ul>
		<br><br>
	</div>
	<div class="main">

<p>ç›®å½•ï¼š<ul><details open>
    <summary></summary>
    <li><a href="#tag-preface" class="noafter">å‰è¨€</a></li>
    <li><a href="#tag-what-is-rsa" class="noafter">Crypto - What is RSA?</a></li>
    <li><a href="#tag-secret-shredder-1" class="noafter">Crypto - Secret Shredder 1</a></li>
    <li><a href="#tag-long-words-1" class="noafter">Crypto - Long Words 1</a></li>
</details></ul></p>
<br><br>

<ul class="section" id="tag-preface"><li>
    å‰è¨€
</li></ul>
<p>è¿™ç¯‡æ–‡ç« æ˜¯2024 SpiritCTF Warmupä¸­ä¸€äº›é¢˜ç›®ï¼ˆè§ç›®å½•ï¼‰çš„å®˜æ–¹é¢˜è§£ã€‚</p>
<br><br>

<ul class="section" id="tag-what-is-rsa"><li>
    Crypto - What is RSA?
</li></ul>

<p>é™„ä»¶åœ¨æ­¤ï¼š</p>
<ul>
    <li><a underlined href="/tales-of-the-martyrs/tales/oracle-of-namagiri/14/what-is-rsa.zip">what-is-rsa.zip</a></li>
</ul>
<br>

<p>RSAæ˜¯ç”±Ron Rivestã€Adi Shamirå’ŒLeonard Adlemanæå‡ºçš„ä¸€ç§éå¯¹ç§°å¯†ç ç³»ç»Ÿã€‚ä¼ è¾“ä¿¡æ¯æ—¶ï¼ŒåŠ å¯†è€…ä½¿ç”¨å…¬é’¥åŠ å¯†ä¿¡æ¯ï¼Œè§£å¯†è€…ä½¿ç”¨ç§é’¥è§£å¯†ä¿¡æ¯ã€‚ä¸å¯¹ç§°å¯†ç ä¸åŒçš„æ˜¯ï¼Œä½¿ç”¨å…¬é’¥åŠ å¯†åçš„ä¿¡æ¯å¿…é¡»ä½¿ç”¨ç§é’¥è§£å¯†ï¼ˆè€Œéå…¬é’¥ï¼‰ã€‚RSAçš„åŸºæœ¬åŸç†æ˜¯æ¬§æ‹‰å®šç†ï¼ˆEuler's theoremï¼‰ï¼ˆå‚è§<a href="https://oi-wiki.org/math/number-theory/fermat/" underlined>OI-Wiki</a>ï¼‰ï¼š</p>

\[
    ed\equiv 1\pmod{\varphi(N)},\quad N=pq,\quad \varphi(N)=(p-1)(q-1)
\]
\[
    c\equiv m^e\pmod{N},\quad c^d\equiv m^{ed}\equiv m^{1+k\varphi(N)}\equiv m\cdot (m^{\varphi(N)})^k\equiv m \pmod{N}
\]

<p>å…¶ä¸­\(e\)æ˜¯æˆ‘ä»¬çš„å…¬é’¥ï¼Œè€Œ\(d\)æ˜¯æˆ‘ä»¬çš„ç§é’¥ï¼Œ\(m,c\)åˆ†åˆ«æ˜¯æ˜æ–‡å’Œå¯†æ–‡ã€‚æœ¬é¢˜ç»™å‡ºäº†\(p,q,e\)çš„å€¼ï¼Œå¹¶ä¸”ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼‰\(e\)ä¸\(\varphi(N)\)ä¸äº’ç´ ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æ±‚è§£\(e\)åœ¨æ¨¡\(\varphi(N)\)æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼ˆå‚è§<a href="https://oi-wiki.org/math/number-theory/inverse/" underlined>OI-Wiki</a>ï¼‰è½»æ˜“åœ°æ±‚å‡º\(d\)çš„å€¼ï¼š</p>

<pre><code class="language-python"># Python 3.x
phi = (p-1) * (q-1)
d = pow(e, -1, phi)</code></pre>
<br>

<p>é€šè¿‡ç§é’¥\(d\)ä¸å¯†æ–‡\(c\)å³å¯è¿˜åŸå‡ºæ˜æ–‡\(m\)çš„å€¼ï¼š</p>
<pre><code class="language-python"># pip install pycryptodome
from Crypto.Util.number import *
m = pow(c, d, N)
flag = long_to_bytes(m)</code></pre>
<br>

<p>å…¶ä¸­æ˜æ–‡çš„å­—èŠ‚ç»è¿‡å¤§ç«¯åºç¼–ç ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="language-text">Char:   S   p   i   r   i   t   {   }   
        |   |   |   |   |   |   |   |
        v   v   v   v   v   v   v   v
Ascii:  53  70  69  72  69  74  7B  7D</code></pre>
<br>

<p>ä¹Ÿå³</p>
<pre><code class="language-python">bytes_to_long(b'Spirit{}') == 0x5370697269747B7D == 6012421442656041853</code></pre>
<br>

<p>Proof of Conceptï¼š</p>
<ul>
    <li><a underlined href="/tales-of-the-martyrs/tales/oracle-of-namagiri/14/sol_what-is-rsa.py">sol_what-is-rsa.py</a></li>
</ul>
<br>

<p>FlagğŸš©ï¼š</p>
<pre><code class="language-text" style="color:red">Spirit{w3lc0mE_t0_7he_W0rLd_oF_Crypt0graphy_:p}</code></pre>

<br><br>

<ul class="section" id="tag-secret-shredder-1"><li>
    Crypto - Secret Shredder 1
</li></ul>

<p>é™„ä»¶åœ¨æ­¤ï¼š</p>
<ul>
    <li><a underlined href="/tales-of-the-martyrs/tales/oracle-of-namagiri/14/secret-shredder-1.zip">secret-shredder-1.zip</a></li>
</ul>
<br>

<p>ä¹Ÿæ˜¯ä¸€ä¸ªRSAçš„é—®é¢˜ï¼Œä¸è¿‡è¿™æ¬¡æ²¡æœ‰på’Œqäº†ï¼Œå¾—é€šè¿‡å…¶ä»–çš„æ–¹æ³•æŠŠç§é’¥dç»™æ±‚å‡ºæ¥ï¼Œè€Œè¿™é€šå¸¸æ„å‘³ç€æˆ‘ä»¬éœ€è¦çŸ¥é“Nçš„æ‰€æœ‰å› å­ï¼ˆN=pqï¼‰ã€‚é¢˜ç›®æ³„éœ²å‡ºæ¥äº†ä¸€ä¸ªç‰¹æ®Šçš„å‚æ•°dp<comment>ï¼ˆä¹Ÿå³å‘ç”Ÿäº†â€œdpæ³„éœ²â€ï¼‰</comment>ï¼š</p>
<pre><code class="language-python">dp = d % (p-1)</code></pre>
<br>

<p>å°è¯•å°†è¿™ä¸ªå‚æ•°å¸¦å…¥åˆ°å…¬é’¥å’Œç§é’¥æ»¡è¶³çš„æ–¹ç¨‹ä¸­ï¼š</p>
\[
    \begin{aligned}
        e\cdot\text{dp} &= e\cdot (d+k_1(p-1))\\
        &=1+k_2(p-1)(q-1)+k_1e(p-1)\\
        &=1+k(p-1)
    \end{aligned}
\]

<p>ç°åœ¨ï¼Œç”±äº\(0 \le \text{dp} < p-1\)ï¼Œæˆ‘ä»¬çŸ¥é“ï¼š</p>
\[
    0\le k = \frac{e\cdot\text{dp}-1}{p-1} < e
\]

<p>æœ¬é¢˜ä¸­å…¬é’¥æŒ‡æ•°\(e\)æ˜¯ä¸€ä¸ªä¸å¤§çš„æ•°å­—ï¼ˆ<code>0x114514 + 1 = 1131797</code>ï¼‰ï¼Œåœ¨0~eçš„èŒƒå›´å†…ç©·ä¸¾kï¼Œå¯¹äºæ¯ä¸ªkè€Œè¨€è®¡ç®—å¯¹åº”çš„pï¼ŒéªŒè¯pæ˜¯ä¸æ˜¯Nçš„å› å­å³å¯ã€‚</p>
<br>

<p>Proof of Conceptï¼š</p>
<ul>
    <li><a underlined href="/tales-of-the-martyrs/tales/oracle-of-namagiri/14/sol_secret-shredder-1.py">sol_secret-shredder-1.py</a></li>
</ul>
<br>

<p>FlagğŸš©ï¼š</p>
<pre><code class="language-text" style="color:red">Spirit{dp_0r_dq_l3akAg3_1s_dAn6er0us_(s0rt_of)}</code></pre>

<br><br>

<ul class="section" id="tag-long-words-1"><li>
    Crypto - Long Words 1
</li></ul>

<p>é™„ä»¶åœ¨æ­¤ï¼š</p>
<ul>
    <li><a underlined href="/tales-of-the-martyrs/tales/oracle-of-namagiri/14/long-words-1.zip">long-words-1.zip</a></li>
</ul>
<br>

<p>æºç ç¬¬ä¸‰è¡Œç»™äº†ä¸€ä¸ªFlagğŸš©é•¿åº¦çš„æç¤ºï¼š</p>
<pre><code class='language-python'>assert len(flag) == 54    # Oh...</code></pre>
<br>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜æ–‡mçš„å¤§å°å¤§è‡´ä¸ºï¼š</p>
\[
    2^{431}=2^{54\times 8-1}\le m < 2^{54\times 8}=2^{432}
\]

<p>å¯ä»¥æ±‚å‡ºNçš„å¤§å°å¤§è‡´ä¸º</p>
\[
    2^{419} \le N < 2^{420}
\]

<p>åœ¨åŠ è§£å¯†çš„è¿‡ç¨‹ä¸­mä¼šè¢«æ¨¡æ‰Nï¼Œå› æ­¤måœ¨è¶…è¿‡Nçš„æ—¶å€™ä¼šå‘ç”Ÿæ”¹å˜ï¼Œä½†æ˜¯ä¸æ”¹å˜å‰çš„måªç›¸å·®Nçš„æŸä¸ªæ•´æ•°å€ï¼š</p>
\[
    m\bmod{N} = m - k\cdot N,\quad 0 < k < 2^{13}
\]

<p>ç©·ä¸¾è¿™ä¸ªkï¼Œç›´è‡³è§£å‡ºæ¥çš„å­—èŠ‚ä¸²å¼€å¤´ä¸º<code>Spirit{</code>å³å¯ã€‚</p>
<br>

<p>Proof of Conceptï¼š</p>
<ul>
    <li><a underlined href="/tales-of-the-martyrs/tales/oracle-of-namagiri/14/sol_long-words-1.py">sol_long-words-1.py</a></li>
</ul>
<br>

<p>FlagğŸš©ï¼š</p>
<pre><code class="language-text" style="color:red">Spirit{0verflOwing_oF_iNpu7s_1s_Ov3rf1owIn9_0f_j0y_:p}</code></pre>

<br><br>

</div>
<br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><p style="color:gray">Tags: <span style="color:blue"><b>#SpiritCTF</b></span></p>
                    <p><div class="time"></div><span style="color:gray">Time: </span><b>2024-10-03 10:49</b></p><br><br><br><br><br><br>
	<script type="text/javascript" src="/essence-of-the-elders/spirit-of-mathematics/MathJax.js?config=TeX-AMS_HTML" async></script>
	<script type="text/x-mathjax-config;executed=true">
        window.MathJax.Hub.Config({
            showProcessingMessages: false,
            messageStyle: "none",
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [["$", "$"], ["\\(", "\\)"]],
                displayMath: [["$$", "$$"], ["\\[", "\\]"]],
                skipTags: ["script", "noscript", "style", "textarea", "pre", "code", "a"]
            },
            "HTML-CSS": {
                availableFonts: ["STIX", "TeX"],
                showMathMenu: false
            },
			SVG: { linebreaks: {automatic: true } }
        });
        //window.MathJax.Hub.Queue(["Typeset", MathJax.Hub,document.getElementsByClassName("ck-content")]);
	</script>
	<script src="/essence-of-the-elders/spirit-of-codes/prism.js"></script>
</body>
</html>